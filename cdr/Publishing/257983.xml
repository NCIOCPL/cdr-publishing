<CdrDoc Type='PublishingSystem' Id='CDR0000257983'>
<CdrDocCtl>
<DocValStatus readonly="yes">V</DocValStatus>
<DocActiveStatus readonly="yes">A</DocActiveStatus>
<DocTitle readonly="yes">QcFilterSets</DocTitle>
</CdrDocCtl>
<CdrDocXml><![CDATA[<?xml version="1.0" encoding="UTF-8"?><PublishingSystem xmlns:cdr="cips.nci.nih.gov/cdr">
 <SystemName>QcFilterSets</SystemName>
 <SystemDescription>QC all CDR filter sets: vendor filters, QC report filters, etc.</SystemDescription>

<SystemSubset>
  <SubsetName>Term Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for Term vendor documents.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

<!--
   ========================================================================
   Term documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN query_term q
          ON q.doc_id = d.id
       WHERE q.path = '/Term/TermStatus'
         AND q.value IN ('Reviewed-Problematic',
                         'Reviewed-Retain',
                         'Unreviewed')
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor Term Set</SubsetFilterName>
     </SubsetFilter>     
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm> 
    </SubsetFilters>
    <Subdirectory>Terminology</Subdirectory>
   </SubsetSpecification>
   
  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>GlossaryTerm Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for GlossaryTerm vendor documents.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

<!--
   ========================================================================
   GlossaryTerm documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN query_term q
          ON q.doc_id = d.id
       WHERE q.path = '/GlossaryTerm/TermStatus'
         AND q.value = 'Approved'
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor GlossaryTerm Set</SubsetFilterName>
     </SubsetFilter>
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm> 
    </SubsetFilters>
    <Subdirectory>GlossaryTerm</Subdirectory>
   </SubsetSpecification>
   
  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>Protocol Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for protocol vendor documents.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   InScopeProtocol documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN query_term q
          ON q.doc_id = d.id
       WHERE q.path = '/InScopeProtocol/ProtocolAdminInfo'
                    + '/CurrentProtocolStatus'
         AND q.value IN ('Closed', 'Completed', 'Temporarily Closed', 
                         'Active', 'Approved-Not Yet Active')
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor InScopeProtocol Set</SubsetFilterName>
     </SubsetFilter>
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm>  
    </SubsetFilters> 
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>Protocol Full QC Report</SubsetName>
  <SubsetDescription>Filter set for protocol full QC report.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   InScopeProtocol documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN query_term q
          ON q.doc_id = d.id
       WHERE q.path = '/InScopeProtocol/ProtocolAdminInfo'
                    + '/CurrentProtocolStatus'
         AND q.value IN ('Closed', 'Completed', 'Temporarily Closed', 
                         'Active', 'Approved-Not Yet Active')
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:QC InScopeProtocol Set</SubsetFilterName>
     </SubsetFilter>        
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>Protocol Administrative QC Report</SubsetName>
  <SubsetDescription>Filter set for protocol administrative QC report.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   InScopeProtocol documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN query_term q
          ON q.doc_id = d.id
       WHERE q.path = '/InScopeProtocol/ProtocolAdminInfo'
                    + '/CurrentProtocolStatus'
         AND q.value IN ('Closed', 'Completed', 'Temporarily Closed', 
                         'Active', 'Approved-Not Yet Active')
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:QC InScopeProtocol Admin Set</SubsetFilterName>
     </SubsetFilter>   
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>


<SystemSubset>
  <SubsetName>Person Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for person vendor documents.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   Person documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT  TOP ?NumDocs? d.id,
              MAX(v.num)
        FROM  doc_version v
        JOIN  document d
          ON  d.id = v.id
        JOIN  query_term q
          ON  q.doc_id = d.id
       WHERE  q.path = '/Person/Status/CurrentStatus'
         AND (q.value = 'Active'
          OR (q.value = 'Inactive'
         AND  EXISTS (SELECT q2.int_val
                        FROM query_term q2
                        JOIN document d2
                          ON d2.id = q2.doc_id
                        JOIN doc_version v2
                          ON v2.id = d2.id
                       WHERE q2.int_val = d.id
                         AND d2.active_status = 'A'
                         AND v2.publishable = 'Y'
                         AND v2.val_status = 'V'
                         AND q2.path LIKE '%@cdr:ref')))
         AND  v.val_status = 'V'
         AND  v.publishable = 'Y'
         AND  d.active_status = 'A'
    GROUP BY  d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor Person Set</SubsetFilterName>
     </SubsetFilter>
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm>  
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

 <SystemSubset>
  <SubsetName>Person QC Report</SubsetName>
  <SubsetDescription>Filter set for QC report.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   Person documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT  TOP ?NumDocs? d.id,
              MAX(v.num)
        FROM  doc_version v
        JOIN  document d
          ON  d.id = v.id
        JOIN  query_term q
          ON  q.doc_id = d.id
       WHERE  q.path = '/Person/Status/CurrentStatus'
         AND (q.value = 'Active'
          OR (q.value = 'Inactive'
         AND  EXISTS (SELECT q2.int_val
                        FROM query_term q2
                        JOIN document d2
                          ON d2.id = q2.doc_id
                        JOIN doc_version v2
                          ON v2.id = d2.id
                       WHERE q2.int_val = d.id
                         AND d2.active_status = 'A'
                         AND v2.publishable = 'Y'
                         AND v2.val_status = 'V'
                         AND q2.path LIKE '%@cdr:ref')))
         AND  v.val_status = 'V'
         AND  v.publishable = 'Y'
         AND  d.active_status = 'A'
    GROUP BY  d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:QC Person Set</SubsetFilterName>
     </SubsetFilter>
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>Summary Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for summary vendor documents.</SubsetDescription>
  <SubsetParameters>   
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter> 
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>1000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

    <!--
   ========================================================================
   Summary documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN doc_type t
          ON t.id = d.doc_type
       WHERE t.name = 'Summary'
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor Summary Set</SubsetFilterName>
     </SubsetFilter>    
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm>  
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

 <SystemSubset>
  <SubsetName>Summary QC Report Filters</SubsetName>
  <SubsetDescription>Filter set for summary QC report.</SubsetDescription>
  <SubsetParameters>   
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter> 
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>1000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

    <!--
   ========================================================================
   Summary documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT TOP ?NumDocs? d.id,
             MAX(v.num)
        FROM doc_version v
        JOIN document d
          ON d.id = v.id
        JOIN doc_type t
          ON t.id = d.doc_type
       WHERE t.name = 'Summary'
         AND v.val_status = 'V'
         AND v.publishable = 'Y'
         AND d.active_status = 'A'
    GROUP BY d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:QC Summary Set</SubsetFilterName>
     </SubsetFilter>    
    </SubsetFilters>
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

<SystemSubset>
  <SubsetName>Organization Vendor Filters</SubsetName>
  <SubsetDescription>Filter set for organization vendor documents.</SubsetDescription>
  <SubsetParameters>  
   <SubsetParameter>
    <ParmName>ReportOnly</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>InteractiveMode</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>ValidateDocs</ParmName>
    <ParmValue>Yes</ParmValue>
   </SubsetParameter>   
   <SubsetParameter>
    <ParmName>NumDocs</ParmName>
    <ParmValue>50000</ParmValue>
   </SubsetParameter>
   <SubsetParameter>
    <ParmName>AbortOnError</ParmName>
    <ParmValue>50</ParmValue>
   </SubsetParameter>   
  </SubsetParameters>
  <SubsetSpecifications>

   <!--
   ========================================================================
   Organization documents.
   ======================================================================== -->
   <SubsetSpecification>
    <SubsetSelection>
     <SubsetSQL>
      SELECT  TOP ?NumDocs? d.id,
              MAX(v.num)
        FROM  doc_version v
        JOIN  document d
          ON  d.id = v.id
        JOIN  query_term q
          ON  q.doc_id = d.id
       WHERE  q.path = '/Organization/Status/CurrentStatus'
         AND (q.value = 'Active'
          OR (q.value = 'Inactive'
         AND  EXISTS (SELECT q2.int_val
                        FROM query_term q2
                        JOIN document d2
                          ON d2.id = q2.doc_id
                        JOIN doc_version v2
                          ON v2.id = d2.id
                       WHERE q2.int_val = d.id
                         AND d2.active_status = 'A'
                         AND v2.publishable = 'Y'
                         AND v2.val_status = 'V'
                         AND q2.path LIKE '%@cdr:ref')))
         AND  v.val_status = 'V'
         AND  v.publishable = 'Y'
         AND  d.active_status = 'A'
    GROUP BY  d.id
     </SubsetSQL>
    </SubsetSelection>
    <SubsetFilters>
     <SubsetFilter>
      <SubsetFilterName>set:Vendor Organization Set</SubsetFilterName>
     </SubsetFilter>
     <SubsetFilterParm>
      <ParmName>DateFirstPub</ParmName>
      <ParmValue/>
     </SubsetFilterParm>  
    </SubsetFilters>  
   </SubsetSpecification>

  </SubsetSpecifications>

  <SubsetOptions>
   <SubsetOption>
    <OptionName>Destination</OptionName>
    <OptionValue>d:/cdr/filters/Output</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>AbortOnError</OptionName>
    <OptionValue>50</OptionValue>
   </SubsetOption>
   <SubsetOption>
    <OptionName>PublishIfWarnings</OptionName>
    <OptionValue>Yes</OptionValue>
   </SubsetOption>  
  </SubsetOptions>
 </SystemSubset>

</PublishingSystem>
]]>
</CdrDocXml>
</CdrDoc>
